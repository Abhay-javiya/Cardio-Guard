{% extends "base.html" %}

{% block title %}Predict Risk | CardioGuard{% endblock %}

{% block content %}
<div class="container section-block mt-5">
    <div class="row justify-content-center g-4">
        <div class="col-lg-4">
            <div class="side-panel">
                <p class="eyebrow">Live Analysis</p>
                <h2>AI Risk Assessment</h2>
                <p class="text-muted">
                    Enter your health metrics accurately. The model compares your profile against thousands of
                    patterns to estimate risk.
                </p>

                <div class="info-card">
                    <div class="info-icon">
                        <i class="fa-solid fa-user-doctor"></i>
                    </div>
                    <div>
                        <h6>Privacy First</h6>
                        <p>No personal data is stored on our servers.</p>
                    </div>
                </div>

                <div class="info-card">
                    <div class="info-icon info-icon-warm">
                        <i class="fa-solid fa-triangle-exclamation"></i>
                    </div>
                    <div>
                        <h6>Medical Disclaimer</h6>
                        <p>Predictions are educational and not medical advice.</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-7">
            <div class="form-panel">
                <div class="panel-header">
                    <h4>Input Parameters</h4>
                    <p>Provide the most accurate values for a clearer estimate.</p>
                </div>

                <form id="predictionForm">
                    <h6 class="section-label">Vitals & Body Stats</h6>
                    <div class="row g-3 mb-3">
                        <div class="col-md-6">
                            <label for="age" class="form-label" data-bs-toggle="tooltip" title="Age in years">Age
                                (years)</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fa-solid fa-calendar-days"></i></span>
                                <input type="number" class="form-control" id="age" required min="10" max="100"
                                    placeholder="e.g. 45">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="gender" class="form-label">Gender</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fa-solid fa-venus-mars"></i></span>
                                <select class="form-select" id="gender" required>
                                    <option value="" selected disabled>Select...</option>
                                    <option value="2">Male</option>
                                    <option value="1">Female</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="height" class="form-label">Height (cm)</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fa-solid fa-ruler-vertical"></i></span>
                                <input type="number" class="form-control" id="height" required min="50" max="250"
                                    placeholder="175">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="weight" class="form-label">Weight (kg)</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fa-solid fa-weight-scale"></i></span>
                                <input type="number" class="form-control" id="weight" required min="30" max="200"
                                    placeholder="70">
                            </div>
                        </div>
                    </div>

                    <h6 class="section-label">Blood Pressure</h6>
                    <div class="row g-3 mb-3">
                        <div class="col-6">
                            <label for="ap_hi" class="form-label">Systolic BP</label>
                            <input type="number" class="form-control" id="ap_hi" required placeholder="120" min="60"
                                max="250">
                        </div>
                        <div class="col-6">
                            <label for="ap_lo" class="form-label">Diastolic BP</label>
                            <input type="number" class="form-control" id="ap_lo" required placeholder="80" min="40"
                                max="150">
                        </div>
                    </div>

                    <h6 class="section-label">Lab Results & Lifestyle</h6>
                    <div class="row g-3 mb-3">
                        <div class="col-md-6">
                            <label for="cholesterol" class="form-label">Cholesterol</label>
                            <select class="form-select" id="cholesterol" required>
                                <option value="1">Normal</option>
                                <option value="2">Above Normal</option>
                                <option value="3">Well Above Normal</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="gluc" class="form-label">Glucose</label>
                            <select class="form-select" id="gluc" required>
                                <option value="1">Normal</option>
                                <option value="2">Above Normal</option>
                                <option value="3">Well Above Normal</option>
                            </select>
                        </div>
                    </div>

                    <div class="row g-3 mb-4">
                        <div class="col-md-4">
                            <div class="form-check p-3 border rounded check-box-card h-100">
                                <input class="form-check-input" type="checkbox" id="smoke">
                                <label class="form-check-label ms-2" for="smoke">Smoker</label>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-check p-3 border rounded check-box-card h-100">
                                <input class="form-check-input" type="checkbox" id="alco">
                                <label class="form-check-label ms-2" for="alco">Alcohol</label>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-check p-3 border rounded check-box-card h-100">
                                <input class="form-check-input" type="checkbox" id="active" checked>
                                <label class="form-check-label ms-2" for="active">Active</label>
                            </div>
                        </div>
                    </div>

                    <div class="d-grid">
                        <button type="submit" class="btn btn-cta btn-lg rounded-pill" id="predictBtn">
                            Analyze Risk <i class="fa-solid fa-arrow-right ms-2"></i>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="resultModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 rounded-4 shadow-lg text-center p-4">
            <div class="modal-body">
                <div id="loadingSpinner" class="d-none">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p class="mt-3 text-muted">Analyzing your data...</p>
                </div>

                <div id="resultContent" class="d-none">
                    <div class="mb-3" id="iconContainer"></div>
                    <h2 class="fw-bold mb-2" id="resultTitle">Result</h2>
                    <p class="lead mb-4" id="resultMessage">Message</p>

                    <div class="alert alert-warning border-0 shadow-sm text-start font-monospace fs-7 d-flex align-items-start">
                        <i class="fa-solid fa-circle-exclamation text-danger me-2 mt-1 fs-6"></i>
                        <div>
                            <strong>MEDICAL DISCLAIMER:</strong> This tool is for <u>educational purposes only</u>.
                            <br>
                            The model accuracy is approximately <span class="badge bg-danger text-white">73%</span>.
                            <br>
                            It is <strong>NOT</strong> a substitute for professional diagnosis. Please consult a doctor.
                        </div>
                    </div>

                    <button type="button" class="btn btn-outline-ink rounded-pill px-4 mt-2"
                        data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/script.js') }}"></script>
{% endblock %}
